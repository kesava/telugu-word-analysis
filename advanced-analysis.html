<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Telugu Linguistic Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #fafafa;
            color: #1a1a1a;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            padding: 60px 0 40px;
            text-align: center;
            border-bottom: 1px solid #e5e5e5;
            margin-bottom: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 0 0 20px 20px;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 80px;
        }

        .stat-card {
            background: white;
            padding: 32px 24px;
            border-radius: 12px;
            border: 1px solid #e5e5e5;
            text-align: center;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .stat-number {
            display: block;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Chart Sections */
        .chart-section {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .section-header {
            margin-bottom: 32px;
            text-align: center;
        }

        .section-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .section-subtitle {
            font-size: 0.95rem;
            color: #6b7280;
        }

        .chart-container {
            position: relative;
            height: 450px;
            margin: 24px 0;
        }

        .chart-container.small {
            height: 350px;
        }

        .chart-container.large {
            height: 550px;
        }

        /* Advanced Analysis Sections */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 32px;
            margin-bottom: 60px;
        }

        /* Telugu Text Styling */
        .telugu-text {
            font-family: 'Noto Sans Telugu', 'Telugu Sangam MN', sans-serif;
            font-weight: 500;
            font-size: 1.1em;
        }

        /* Insights Cards */
        .insights-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 50px;
            margin: 60px 0;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 28px;
            margin-top: 32px;
        }

        .insight-card {
            background: white;
            padding: 28px;
            border-radius: 10px;
            border: 1px solid #e5e5e5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            transition: all 0.2s ease;
        }

        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .insight-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 12px;
        }

        .insight-text {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.7;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-tab {
            background: #f9f9f9;
            border: 2px solid #e5e5e5;
            color: #6b7280;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-tab:hover {
            background: #f3f4f6;
            color: #4b5563;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        /* Loading and Error States */
        .loading {
            text-align: center;
            padding: 80px 20px;
            color: #9ca3af;
            font-size: 1rem;
        }

        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            text-align: center;
        }

        /* Advanced Feature Highlights */
        .feature-highlight {
            background: linear-gradient(135deg, #667eea10, #764ba210);
            border-left: 4px solid #667eea;
            padding: 24px;
            margin: 24px 0;
            border-radius: 0 8px 8px 0;
        }

        .feature-title {
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }

            header {
                padding: 40px 0 30px;
                margin-bottom: 40px;
            }

            h1 {
                font-size: 2.2rem;
            }

            .chart-section, .insights-section {
                padding: 28px;
            }

            .chart-container {
                height: 350px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 16px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Advanced Telugu Linguistic Analysis</h1>
            <p class="subtitle">Comprehensive analysis of 54,265+ Telugu words with advanced linguistic insights</p>
        </header>

        <div class="stats-grid" id="stats-overview">
            <div class="loading">Loading comprehensive statistics...</div>
        </div>

        <div class="feature-highlight">
            <div class="feature-title">ðŸ§  Advanced Analysis Features</div>
            <p>This analysis includes Telugu-specific morphological patterns, phonetic structures, semantic classifications, and cognitive load assessments - providing deep insights into Telugu language structure.</p>
        </div>

        <!-- Basic Syllable Analysis -->
        <div class="chart-section">
            <div class="section-header">
                <h2 class="section-title">Syllable Frequency Analysis</h2>
                <p class="section-subtitle">Most common Telugu syllables and consonant-vowel combinations</p>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSyllableChart('frequency')">Most Frequent</button>
                <button class="nav-tab" onclick="showSyllableChart('consonants')">Consonants</button>
                <button class="nav-tab" onclick="showSyllableChart('combinations')">CV Combinations</button>
            </div>
            <div class="chart-container">
                <canvas id="syllableChart"></canvas>
            </div>
        </div>

        <!-- Telugu Linguistics Analysis -->
        <div class="analysis-grid">
            <div class="chart-section">
                <div class="section-header">
                    <h2 class="section-title">Telugu Loan Word Distribution</h2>
                    <p class="section-subtitle">Etymology analysis: Sanskrit, Arabic, English vs Native Telugu</p>
                </div>
                <div class="chart-container small">
                    <canvas id="loanWordChart"></canvas>
                </div>
            </div>

            <div class="chart-section">
                <div class="section-header">
                    <h2 class="section-title">Case Markers Usage</h2>
                    <p class="section-subtitle">Grammatical case markers in Telugu words</p>
                </div>
                <div class="chart-container small">
                    <canvas id="caseMarkerChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Morphological Analysis -->
        <div class="chart-section">
            <div class="section-header">
                <h2 class="section-title">Morphological Analysis</h2>
                <p class="section-subtitle">Prefix and suffix patterns in Telugu word formation</p>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showMorphologyChart('prefixes')">Prefixes</button>
                <button class="nav-tab" onclick="showMorphologyChart('suffixes')">Suffixes</button>
                <button class="nav-tab" onclick="showMorphologyChart('roots')">Root Patterns</button>
            </div>
            <div class="chart-container">
                <canvas id="morphologyChart"></canvas>
            </div>
        </div>

        <!-- Phonetic Analysis -->
        <div class="analysis-grid">
            <div class="chart-section">
                <div class="section-header">
                    <h2 class="section-title">Consonant Clusters</h2>
                    <p class="section-subtitle">Most common consonant combinations in Telugu</p>
                </div>
                <div class="chart-container small">
                    <canvas id="consonantClusterChart"></canvas>
                </div>
            </div>

            <div class="chart-section">
                <div class="section-header">
                    <h2 class="section-title">Sandhi Patterns</h2>
                    <p class="section-subtitle">Sound change patterns at word boundaries</p>
                </div>
                <div class="chart-container small">
                    <canvas id="sandhiChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Semantic Analysis -->
        <div class="chart-section">
            <div class="section-header">
                <h2 class="section-title">Word Complexity & Cognitive Load</h2>
                <p class="section-subtitle">Semantic complexity and processing difficulty analysis</p>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSemanticChart('complexity')">Word Complexity</button>
                <button class="nav-tab" onclick="showSemanticChart('classes')">Word Classes</button>
                <button class="nav-tab" onclick="showSemanticChart('cognitive')">Cognitive Load</button>
            </div>
            <div class="chart-container">
                <canvas id="semanticChart"></canvas>
            </div>
        </div>

        <!-- Advanced Insights -->
        <div class="insights-section">
            <div class="section-header">
                <h2 class="section-title">Advanced Linguistic Insights</h2>
                <p class="section-subtitle">Deep analysis findings about Telugu language structure</p>
            </div>
            <div class="insights-grid" id="advanced-insights">
                <div class="loading">Generating advanced linguistic insights...</div>
            </div>
        </div>

        <!-- Word Formation Analysis -->
        <div class="chart-section">
            <div class="section-header">
                <h2 class="section-title">Word Formation Patterns</h2>
                <p class="section-subtitle">How Telugu words are constructed linguistically</p>
            </div>
            <div class="chart-container large">
                <canvas id="formationChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        let statsData = null;
        let charts = {};

        // Advanced color palette for linguistics
        const colors = {
            primary: '#667eea',
            secondary: '#764ba2',
            accent: '#f093fb',
            success: '#4facfe',
            warning: '#43e97b',
            danger: '#fa709a',
            neutral: '#6b7280',
            gradients: [
                '#667eea', '#764ba2', '#f093fb', '#4facfe',
                '#43e97b', '#fa709a', '#38d9a9', '#845ec2',
                '#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24'
            ]
        };

        // Enhanced Chart.js defaults
        Chart.defaults.font.family = 'Inter, -apple-system, BlinkMacSystemFont, sans-serif';
        Chart.defaults.font.size = 12;
        Chart.defaults.color = '#6b7280';
        Chart.defaults.borderColor = '#e5e7eb';
        Chart.defaults.plugins.legend.labels.usePointStyle = true;
        Chart.defaults.plugins.legend.labels.boxWidth = 8;
        Chart.defaults.plugins.legend.labels.boxHeight = 8;

        async function loadData() {
            try {
                const response = await fetch('./telugu-stats.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const text = await response.text();
                if (!text.trim()) {
                    throw new Error('Empty response from server');
                }

                statsData = JSON.parse(text);

                // Validate comprehensive data structure
                if (!statsData.basic || !statsData.syllableAnalysis || !statsData.teluguLinguistics) {
                    throw new Error('Advanced analysis data not found');
                }

                displayOverviewStats();
                createAllCharts();
                generateAdvancedInsights();

                console.log('âœ… Advanced Telugu linguistic analysis loaded successfully');
                console.log('ðŸ“Š Analysis coverage:', {
                    totalWords: statsData.basic.totalWords,
                    uniqueSyllables: statsData.syllableAnalysis?.totalUniqueSyllables,
                    loanWords: statsData.teluguLinguistics?.loanWordDistribution,
                    morphology: statsData.morphology ? 'Available' : 'Missing',
                    phonetics: statsData.phonetics ? 'Available' : 'Missing',
                    semantics: statsData.semanticPatterns ? 'Available' : 'Missing'
                });
            } catch (error) {
                console.error('Error loading advanced analysis:', error);

                let errorMessage = 'âŒ Failed to load advanced analysis data. ';
                if (error.message.includes('HTTP')) {
                    errorMessage += 'Network error - ensure server is running.';
                } else if (error.message.includes('JSON')) {
                    errorMessage += 'Data file is corrupted.';
                } else {
                    errorMessage += error.message;
                }

                document.querySelectorAll('.loading').forEach(el => {
                    el.innerHTML = `<div class="error">${errorMessage}</div>`;
                });
            }
        }

        function displayOverviewStats() {
            const container = document.getElementById('stats-overview');
            const basic = statsData.basic;
            const syllables = statsData.syllableAnalysis;
            const linguistics = statsData.teluguLinguistics;
            const morphology = statsData.morphology;

            container.innerHTML = `
                <div class="stat-card">
                    <span class="stat-number">${basic.totalWords.toLocaleString()}</span>
                    <span class="stat-label">Total Words</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${syllables?.syllablesPerWord?.averageSyllablesPerWord || 'N/A'}</span>
                    <span class="stat-label">Avg Syllables</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${syllables?.totalUniqueSyllables?.toLocaleString() || 'N/A'}</span>
                    <span class="stat-label">Unique Syllables</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${linguistics?.loanWordDistribution?.native?.percentage || 'N/A'}%</span>
                    <span class="stat-label">Native Telugu</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${morphology?.prefixFrequency?.length || 'N/A'}</span>
                    <span class="stat-label">Prefix Types</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${(statsData.phonetics?.consonantClusters?.length || 0)}</span>
                    <span class="stat-label">Consonant Clusters</span>
                </div>
            `;
        }

        function createAllCharts() {
            createSyllableChart('frequency');
            createLoanWordChart();
            createCaseMarkerChart();
            createMorphologyChart('prefixes');
            createConsonantClusterChart();
            createSandhiChart();
            createSemanticChart('complexity');
            createFormationChart();
        }

        function createSyllableChart(mode = 'frequency') {
            const ctx = document.getElementById('syllableChart').getContext('2d');
            if (charts.syllable) charts.syllable.destroy();

            let data, chartType = 'bar';

            if (mode === 'frequency') {
                data = (statsData.syllableAnalysis?.mostFrequentSyllables || []).slice(0, 15);
                chartType = 'bar';
            } else if (mode === 'consonants') {
                data = (statsData.syllableAnalysis?.consonantFrequency || []).slice(0, 12);
                chartType = 'doughnut';
            } else if (mode === 'combinations') {
                data = (statsData.aksharams?.consonantVowelCombinations || []).slice(0, 12);
                chartType = 'bar';
            }

            const config = {
                type: chartType,
                data: chartType === 'doughnut' ? {
                    labels: data.map(item => item.consonant || item.combination || item.syllable),
                    datasets: [{
                        data: data.map(item => item.count),
                        backgroundColor: colors.gradients.slice(0, data.length),
                        borderWidth: 0,
                        hoverBorderWidth: 3,
                        hoverBorderColor: '#ffffff'
                    }]
                } : {
                    labels: data.map(item => item.syllable || item.combination || item.consonant),
                    datasets: [{
                        data: data.map(item => item.count),
                        backgroundColor: colors.primary,
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: chartType === 'doughnut' ? {
                            position: 'right',
                            labels: {
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter', size: 14 },
                                padding: 20
                            }
                        } : { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.syllable || item.consonant || item.combination}: ${item.percentage}%`;
                                }
                            }
                        }
                    },
                    scales: chartType !== 'doughnut' ? {
                        y: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' },
                            ticks: { color: colors.neutral }
                        },
                        x: {
                            border: { display: false },
                            grid: { display: false },
                            ticks: {
                                color: colors.neutral,
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter', size: 16 }
                            }
                        }
                    } : undefined
                }
            };

            charts.syllable = new Chart(ctx, config);
        }

        function createLoanWordChart() {
            const ctx = document.getElementById('loanWordChart').getContext('2d');
            const data = statsData.teluguLinguistics?.loanWordDistribution;

            if (!data) return;

            charts.loanWord = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Native Telugu', 'Sanskrit Origin', 'Arabic Origin', 'English Origin'],
                    datasets: [{
                        data: [data.native.percentage, data.sanskrit.percentage,
                               data.arabic.percentage, data.english.percentage],
                        backgroundColor: [colors.success, colors.primary, colors.warning, colors.accent],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { padding: 20 }
                        },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const labels = ['native', 'sanskrit', 'arabic', 'english'];
                                    const key = labels[context.dataIndex];
                                    return `${context.label}: ${context.parsed}% (${data[key].count.toLocaleString()} words)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createCaseMarkerChart() {
            const ctx = document.getElementById('caseMarkerChart').getContext('2d');
            const data = (statsData.teluguLinguistics?.caseMarkers || []).slice(0, 10);

            charts.caseMarker = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(item => item.marker),
                    datasets: [{
                        data: data.map(item => item.count),
                        backgroundColor: colors.secondary,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.marker}: ${item.count.toLocaleString()} (${item.percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' }
                        },
                        y: {
                            border: { display: false },
                            grid: { display: false },
                            ticks: {
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter', size: 14 }
                            }
                        }
                    }
                }
            });
        }

        function createMorphologyChart(mode = 'prefixes') {
            const ctx = document.getElementById('morphologyChart').getContext('2d');
            if (charts.morphology) charts.morphology.destroy();

            let data, title;

            if (mode === 'prefixes') {
                data = (statsData.morphology?.prefixFrequency || []).slice(0, 12);
                title = 'Most Common Prefixes';
            } else if (mode === 'suffixes') {
                data = (statsData.morphology?.suffixFrequency || []).slice(0, 12);
                title = 'Most Common Suffixes';
            } else if (mode === 'roots') {
                data = (statsData.morphology?.rootPatterns || []).slice(0, 10);
                title = 'Root Patterns (CV Structure)';
            }

            charts.morphology = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(item => item.prefix || item.suffix || item.pattern),
                    datasets: [{
                        label: title,
                        data: data.map(item => item.count),
                        borderColor: colors.accent,
                        backgroundColor: colors.accent + '20',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointHoverRadius: 7,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.prefix || item.suffix || item.pattern}: ${item.count.toLocaleString()} (${item.percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' }
                        },
                        x: {
                            border: { display: false },
                            grid: { display: false },
                            ticks: {
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter' }
                            }
                        }
                    }
                }
            });
        }

        function createConsonantClusterChart() {
            const ctx = document.getElementById('consonantClusterChart').getContext('2d');
            const data = (statsData.phonetics?.consonantClusters || []).slice(0, 12);

            charts.consonantCluster = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: data.map(item => item.cluster),
                    datasets: [{
                        label: 'Frequency',
                        data: data.map(item => item.count),
                        borderColor: colors.warning,
                        backgroundColor: colors.warning + '30',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.cluster}: ${item.count.toLocaleString()} (${item.percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' },
                            ticks: { display: false },
                            pointLabels: {
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter', size: 14 }
                            }
                        }
                    }
                }
            });
        }

        function createSandhiChart() {
            const ctx = document.getElementById('sandhiChart').getContext('2d');
            const data = (statsData.teluguLinguistics?.sandhiPatterns || []).slice(0, 10);

            charts.sandhi = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Sandhi Patterns',
                        data: data.map((item, index) => ({
                            x: index,
                            y: item.count,
                            pattern: item.pattern
                        })),
                        backgroundColor: colors.danger,
                        borderColor: colors.danger,
                        pointRadius: 8,
                        pointHoverRadius: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                title: function(context) {
                                    return context[0].raw.pattern;
                                },
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `Frequency: ${item.count.toLocaleString()} (${item.percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' },
                            title: { display: true, text: 'Frequency' }
                        },
                        x: {
                            type: 'linear',
                            border: { display: false },
                            grid: { display: false },
                            ticks: {
                                callback: function(value) {
                                    return data[value]?.pattern || '';
                                },
                                font: { family: 'Telugu Sangam MN, Noto Sans Telugu, Inter' }
                            }
                        }
                    }
                }
            });
        }

        function createSemanticChart(mode = 'complexity') {
            const ctx = document.getElementById('semanticChart').getContext('2d');
            if (charts.semantic) charts.semantic.destroy();

            let data, chartType;

            if (mode === 'complexity') {
                data = statsData.semanticPatterns?.wordComplexity || [];
                chartType = 'polarArea';
            } else if (mode === 'classes') {
                data = (statsData.semanticPatterns?.wordClasses || []).slice(0, 8);
                chartType = 'doughnut';
            } else if (mode === 'cognitive') {
                data = statsData.semanticPatterns?.cognitiveLoad || [];
                chartType = 'bar';
            }

            const config = {
                type: chartType,
                data: {
                    labels: data.map(item => item.category || item.wordClass),
                    datasets: [{
                        data: data.map(item => item.percentage || item.count),
                        backgroundColor: colors.gradients.slice(0, data.length),
                        borderWidth: chartType === 'bar' ? 0 : 2,
                        borderColor: chartType !== 'bar' ? '#ffffff' : undefined,
                        borderRadius: chartType === 'bar' ? 4 : undefined
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: chartType === 'doughnut' ? 'right' : 'bottom',
                            labels: { padding: 16 }
                        },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.category || item.wordClass}: ${item.percentage}% (${item.count?.toLocaleString()} words)`;
                                }
                            }
                        }
                    },
                    scales: chartType === 'bar' ? {
                        y: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' }
                        },
                        x: {
                            border: { display: false },
                            grid: { display: false }
                        }
                    } : (chartType === 'polarArea' ? {
                        r: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' },
                            ticks: { display: false }
                        }
                    } : undefined)
                }
            };

            charts.semantic = new Chart(ctx, config);
        }

        function createFormationChart() {
            const ctx = document.getElementById('formationChart').getContext('2d');
            const data = (statsData.semanticPatterns?.wordFormation || []).slice(0, 8);

            charts.formation = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(item => item.formation.replace('_', ' ')),
                    datasets: [{
                        data: data.map(item => item.percentage),
                        backgroundColor: colors.gradients.slice(0, data.length),
                        borderRadius: 6,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.primary,
                            callbacks: {
                                label: function(context) {
                                    const item = data[context.dataIndex];
                                    return `${item.formation.replace('_', ' ')}: ${item.percentage}% (${item.count?.toLocaleString()} words)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            border: { display: false },
                            grid: { color: '#f3f4f6' },
                            title: { display: true, text: 'Percentage of Words' }
                        },
                        x: {
                            border: { display: false },
                            grid: { display: false },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }

        function generateAdvancedInsights() {
            const insights = [
                {
                    title: "Telugu Language Purity",
                    text: `${statsData.teluguLinguistics?.loanWordDistribution?.native?.percentage || 'N/A'}% of analyzed words are native Telugu, showing strong linguistic preservation despite historical influences from Sanskrit (${statsData.teluguLinguistics?.loanWordDistribution?.sanskrit?.percentage || 'N/A'}%) and other languages.`
                },
                {
                    title: "Morphological Complexity",
                    text: `Telugu shows rich morphological patterns with ${statsData.morphology?.prefixFrequency?.length || 'multiple'} distinct prefix types and ${statsData.morphology?.suffixFrequency?.length || 'numerous'} suffix patterns, indicating sophisticated word formation mechanisms.`
                },
                {
                    title: "Phonetic Structure",
                    text: `Analysis reveals ${statsData.phonetics?.consonantClusters?.length || 'numerous'} distinct consonant cluster patterns, with gemination (doubled consonants) being particularly frequent, reflecting Telugu's phonotactic preferences.`
                },
                {
                    title: "Syllabic Organization",
                    text: `Average syllable count of ${statsData.syllableAnalysis?.syllablesPerWord?.averageSyllablesPerWord || 'N/A'} per word demonstrates Telugu's syllable-timed rhythm, with ${statsData.syllableAnalysis?.totalUniqueSyllables || 'thousands'} unique syllable combinations showing remarkable diversity.`
                },
                {
                    title: "Cognitive Processing",
                    text: `Word complexity analysis shows ${statsData.semanticPatterns?.wordComplexity?.find(item => item.category === 'medium')?.percentage || 'significant'}% of words have medium complexity, suggesting optimal balance between expressiveness and processing ease.`
                },
                {
                    title: "Grammatical Cases",
                    text: `Case marker analysis reveals that "${statsData.teluguLinguistics?.caseMarkers?.[0]?.marker || 'à°¨'}" is the most frequent case marker at ${statsData.teluguLinguistics?.caseMarkers?.[0]?.percentage || 'N/A'}%, highlighting Telugu's agglutinative nature.`
                }
            ];

            document.getElementById('advanced-insights').innerHTML = insights.map(insight => `
                <div class="insight-card">
                    <h3 class="insight-title">${insight.title}</h3>
                    <p class="insight-text">${insight.text}</p>
                </div>
            `).join('');
        }

        // Navigation functions
        function showSyllableChart(mode) {
            document.querySelector('#syllableChart').closest('.chart-section').querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            createSyllableChart(mode);
        }

        function showMorphologyChart(mode) {
            document.querySelector('#morphologyChart').closest('.chart-section').querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            createMorphologyChart(mode);
        }

        function showSemanticChart(mode) {
            document.querySelector('#semanticChart').closest('.chart-section').querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            createSemanticChart(mode);
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>